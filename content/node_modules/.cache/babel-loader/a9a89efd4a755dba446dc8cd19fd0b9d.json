{"ast":null,"code":"\"use strict\";\n\nvar _toConsumableArray = require(\"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nvar _createForOfIteratorHelper = require(\"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createForOfIteratorHelper\");\n\nvar _regeneratorRuntime = require(\"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.unpackTags = exports.decodeTagAt = exports.decodeTag = exports.decodeData = void 0;\n/**\r\n * Decode the data content of a DataItem, either to a string or Uint8Array of bytes\r\n *\r\n * @param deps\r\n * @param d\r\n * @param param2\r\n */\n\nfunction decodeData(deps, d) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n    string: false\n  };\n  return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!options.string) {\n              _context.next = 4;\n              break;\n            }\n\n            return _context.abrupt(\"return\", deps.utils.b64UrlToString(d.data));\n\n          case 4:\n            return _context.abrupt(\"return\", deps.utils.b64UrlToBuffer(d.data));\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n}\n\nexports.decodeData = decodeData;\n/**\r\n * Decode an individual tag from a DataItem. Always decodes name and value as strings\r\n *\r\n * @param deps\r\n * @param tag\r\n */\n\nfunction decodeTag(deps, tag) {\n  return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            return _context2.abrupt(\"return\", {\n              name: deps.utils.b64UrlToString(tag.name),\n              value: deps.utils.b64UrlToString(tag.value)\n            });\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n}\n\nexports.decodeTag = decodeTag;\n/**\r\n * Decodes an individual tag from a DataItem at index. Throws if index is out of bounds.\r\n *\r\n */\n\nfunction decodeTagAt(deps, d, index) {\n  return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!(d.tags.length < index - 1)) {\n              _context3.next = 2;\n              break;\n            }\n\n            throw new Error(\"Invalid index \".concat(index, \" when tags array has \").concat(d.tags.length, \" tags\"));\n\n          case 2:\n            return _context3.abrupt(\"return\", decodeTag(deps, d.tags[index]));\n\n          case 3:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n}\n\nexports.decodeTagAt = decodeTagAt;\n/**\r\n * Unpack all tags in a DataItem into a key value map of\r\n *\r\n * `name: string | string[]`\r\n *\r\n * Always decodes as string values, maintains the order\r\n * the tags were seriliazed in when converting a collection\r\n * of tags with the same key.\r\n *\r\n * @param deps\r\n * @param d\r\n */\n\nfunction unpackTags(deps, d) {\n  return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n    var tags, _iterator, _step, tag, _yield$decodeTag, name, value;\n\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            tags = {};\n            _iterator = _createForOfIteratorHelper(d.tags);\n            _context4.prev = 2;\n\n            _iterator.s();\n\n          case 4:\n            if ((_step = _iterator.n()).done) {\n              _context4.next = 17;\n              break;\n            }\n\n            tag = _step.value;\n            _context4.next = 8;\n            return decodeTag(deps, tag);\n\n          case 8:\n            _yield$decodeTag = _context4.sent;\n            name = _yield$decodeTag.name;\n            value = _yield$decodeTag.value;\n\n            if (tags.hasOwnProperty(name)) {\n              _context4.next = 14;\n              break;\n            }\n\n            tags[name] = value;\n            return _context4.abrupt(\"continue\", 15);\n\n          case 14:\n            tags[name] = [].concat(_toConsumableArray(tags[name]), [value]);\n\n          case 15:\n            _context4.next = 4;\n            break;\n\n          case 17:\n            _context4.next = 22;\n            break;\n\n          case 19:\n            _context4.prev = 19;\n            _context4.t0 = _context4[\"catch\"](2);\n\n            _iterator.e(_context4.t0);\n\n          case 22:\n            _context4.prev = 22;\n\n            _iterator.f();\n\n            return _context4.finish(22);\n\n          case 25:\n            return _context4.abrupt(\"return\", tags);\n\n          case 26:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[2, 19, 22, 25]]);\n  }));\n}\n\nexports.unpackTags = unpackTags;","map":{"version":3,"sources":["/home/al/Desktop/koi/narcissus/content/node_modules/arweave-bundles/lib/ar-data-read.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","unpackTags","decodeTagAt","decodeTag","decodeData","deps","d","options","string","utils","b64UrlToString","data","b64UrlToBuffer","tag","name","index","tags","length","Error","hasOwnProperty"],"mappings":"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","sourcesContent":["\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.unpackTags = exports.decodeTagAt = exports.decodeTag = exports.decodeData = void 0;\r\n/**\r\n * Decode the data content of a DataItem, either to a string or Uint8Array of bytes\r\n *\r\n * @param deps\r\n * @param d\r\n * @param param2\r\n */\r\nfunction decodeData(deps, d, options = { string: false }) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (options.string) {\r\n            return deps.utils.b64UrlToString(d.data);\r\n        }\r\n        else {\r\n            return deps.utils.b64UrlToBuffer(d.data);\r\n        }\r\n    });\r\n}\r\nexports.decodeData = decodeData;\r\n/**\r\n * Decode an individual tag from a DataItem. Always decodes name and value as strings\r\n *\r\n * @param deps\r\n * @param tag\r\n */\r\nfunction decodeTag(deps, tag) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        return {\r\n            name: deps.utils.b64UrlToString(tag.name),\r\n            value: deps.utils.b64UrlToString(tag.value),\r\n        };\r\n    });\r\n}\r\nexports.decodeTag = decodeTag;\r\n/**\r\n * Decodes an individual tag from a DataItem at index. Throws if index is out of bounds.\r\n *\r\n */\r\nfunction decodeTagAt(deps, d, index) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (d.tags.length < index - 1) {\r\n            throw new Error(`Invalid index ${index} when tags array has ${d.tags.length} tags`);\r\n        }\r\n        return decodeTag(deps, d.tags[index]);\r\n    });\r\n}\r\nexports.decodeTagAt = decodeTagAt;\r\n/**\r\n * Unpack all tags in a DataItem into a key value map of\r\n *\r\n * `name: string | string[]`\r\n *\r\n * Always decodes as string values, maintains the order\r\n * the tags were seriliazed in when converting a collection\r\n * of tags with the same key.\r\n *\r\n * @param deps\r\n * @param d\r\n */\r\nfunction unpackTags(deps, d) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const tags = {};\r\n        for (const tag of d.tags) {\r\n            const { name, value } = yield decodeTag(deps, tag);\r\n            if (!tags.hasOwnProperty(name)) {\r\n                tags[name] = value;\r\n                continue;\r\n            }\r\n            tags[name] = [...tags[name], value];\r\n        }\r\n        return tags;\r\n    });\r\n}\r\nexports.unpackTags = unpackTags;\r\n"]},"metadata":{},"sourceType":"script"}