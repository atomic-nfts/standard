{"ast":null,"code":"import { decomposeRsaPrivateKey, composeRsaPrivateKey } from '../raw/keys';\nimport { decodeAsn1, encodeAsn1 } from '../../util/asn1-encoder';\nimport { EcParameters, EcPrivateKey, CurvePrivateKey } from '../../util/asn1-entities';\nimport { decodeEcPoint, encodeEcPoint, validateEcD } from '../../util/ec';\nimport { hexStringToUint8Array } from '../../util/binary';\nimport { UnsupportedAlgorithmError } from '../../util/errors';\nimport { OIDS, FLIPPED_OIDS } from '../../util/oids';\nimport { KEY_TYPES } from '../../util/key-types';\n\nconst decomposeRsaPrivateKeyInfo = privateKeyInfo => {\n  const {\n    privateKeyAlgorithm,\n    privateKey: privateKeyAsn1\n  } = privateKeyInfo;\n  const keyAlgorithm = {\n    id: OIDS[privateKeyAlgorithm.id]\n  };\n\n  switch (keyAlgorithm.id) {\n    case 'rsa-encryption':\n    case 'md2-with-rsa-encryption':\n    case 'md4-with-rsa-encryption':\n    case 'md5-with-rsa-encryption':\n    case 'sha1-with-rsa-encryption':\n    case 'sha224-with-rsa-encryption':\n    case 'sha256-with-rsa-encryption':\n    case 'sha384-with-rsa-encryption':\n    case 'sha512-with-rsa-encryption':\n    case 'sha512-224-with-rsa-encryption':\n    case 'sha512-256-with-rsa-encryption':\n      break;\n\n    /* istanbul ignore next */\n\n    case 'rsaes-oaep':\n      throw new UnsupportedAlgorithmError('RSA-OAEP keys are not yet supported');\n\n    /* istanbul ignore next */\n\n    case 'rsassa-pss':\n      throw new UnsupportedAlgorithmError('RSA-PSS keys are not yet supported');\n\n    /* istanbul ignore next */\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key algorithm OID '${privateKeyAlgorithm.id}'`);\n  }\n\n  const {\n    keyData\n  } = decomposeRsaPrivateKey(privateKeyAsn1);\n  return {\n    keyAlgorithm: {\n      id: OIDS[privateKeyAlgorithm.id]\n    },\n    keyData\n  };\n};\n\nconst composeRsaPrivateKeyInfo = (keyAlgorithm, keyData) => {\n  const rsaPrivateKeyAsn1 = composeRsaPrivateKey(keyAlgorithm, keyData);\n  return {\n    version: 0,\n    privateKeyAlgorithm: {\n      id: FLIPPED_OIDS[keyAlgorithm.id],\n      parameters: hexStringToUint8Array('0500')\n    },\n    privateKey: rsaPrivateKeyAsn1\n  };\n};\n\nconst decomposeEcPrivateKeyInfo = privateKeyInfo => {\n  const {\n    privateKeyAlgorithm,\n    privateKey: privateKeyAsn1\n  } = privateKeyInfo;\n  const ecParameters = decodeAsn1(privateKeyAlgorithm.parameters, EcParameters);\n  const ecPrivateKey = decodeAsn1(privateKeyAsn1, EcPrivateKey); // Validate parameters & publicKey\n\n  /* istanbul ignore if */\n\n  if (ecParameters.type !== 'namedCurve') {\n    throw new UnsupportedAlgorithmError('Only EC named curves are supported');\n  }\n  /* istanbul ignore if */\n\n\n  if (!ecPrivateKey.publicKey) {\n    throw new UnsupportedAlgorithmError('Missing publicKey from ECPrivateKey');\n  } // Ensure that the named curve is supported\n\n\n  const namedCurve = OIDS[ecParameters.value];\n\n  if (!namedCurve) {\n    throw new UnsupportedAlgorithmError(`Unsupported named curve OID '${ecParameters.value}'`);\n  } // Validate & get encoded point\n\n\n  const {\n    x,\n    y\n  } = decodeEcPoint(namedCurve, ecPrivateKey.publicKey.data);\n  return {\n    keyAlgorithm: {\n      id: 'ec-public-key',\n      namedCurve\n    },\n    keyData: {\n      d: ecPrivateKey.privateKey,\n      x,\n      y\n    }\n  };\n};\n\nconst composeEcPrivateKeyInfo = (keyAlgorithm, keyData) => {\n  // Validate named curve\n  const namedCurveOid = FLIPPED_OIDS[keyAlgorithm.namedCurve];\n\n  if (!namedCurveOid) {\n    throw new UnsupportedAlgorithmError(`Unsupported named curve '${keyAlgorithm.namedCurve}'`);\n  } // Validate D value (private key)\n\n\n  const privateKey = validateEcD(keyAlgorithm.namedCurve, keyData.d); // Validate & encode point (public key)\n\n  const publicKey = encodeEcPoint(keyAlgorithm.namedCurve, keyData.x, keyData.y);\n  const ecPrivateKey = {\n    version: 1,\n    privateKey,\n    publicKey: {\n      unused: 0,\n      data: publicKey\n    }\n  };\n  const ecPrivateKeyAsn1 = encodeAsn1(ecPrivateKey, EcPrivateKey);\n  const ecParametersAsn1 = encodeAsn1({\n    type: 'namedCurve',\n    value: namedCurveOid\n  }, EcParameters);\n  return {\n    version: 0,\n    privateKeyAlgorithm: {\n      id: FLIPPED_OIDS[keyAlgorithm.id],\n      parameters: ecParametersAsn1\n    },\n    privateKey: ecPrivateKeyAsn1\n  };\n};\n\nconst decomposeEd25519PrivateKeyInfo = privateKeyInfo => {\n  // See: https://tools.ietf.org/html/rfc8032#section-5.1.5\n  const {\n    privateKeyAlgorithm,\n    privateKey\n  } = privateKeyInfo;\n  const seed = decodeAsn1(privateKey, CurvePrivateKey);\n  return {\n    keyAlgorithm: {\n      id: OIDS[privateKeyAlgorithm.id]\n    },\n    keyData: {\n      seed\n    }\n  };\n};\n\nconst composeEd25519PrivateKeyInfo = (keyAlgorithm, keyData) => ({\n  version: 0,\n  privateKeyAlgorithm: {\n    id: FLIPPED_OIDS[keyAlgorithm.id]\n  },\n  privateKey: encodeAsn1(keyData.seed, CurvePrivateKey)\n});\n\nexport const decomposePrivateKeyInfo = privateKeyInfo => {\n  const keyType = KEY_TYPES[OIDS[privateKeyInfo.privateKeyAlgorithm.id]];\n\n  switch (keyType) {\n    case 'rsa':\n      return decomposeRsaPrivateKeyInfo(privateKeyInfo);\n\n    case 'ec':\n      return decomposeEcPrivateKeyInfo(privateKeyInfo);\n\n    case 'ed25519':\n      return decomposeEd25519PrivateKeyInfo(privateKeyInfo);\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key algorithm OID '${privateKeyInfo.privateKeyAlgorithm.id}'`);\n  }\n};\nexport const composePrivateKeyInfo = (keyAlgorithm, keyData) => {\n  const keyType = KEY_TYPES[keyAlgorithm.id];\n\n  switch (keyType) {\n    case 'rsa':\n      return composeRsaPrivateKeyInfo(keyAlgorithm, keyData);\n\n    case 'ec':\n      return composeEcPrivateKeyInfo(keyAlgorithm, keyData);\n\n    case 'ed25519':\n      return composeEd25519PrivateKeyInfo(keyAlgorithm, keyData);\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key algorithm id '${keyAlgorithm.id}'`);\n  }\n};","map":{"version":3,"sources":["/home/al/Desktop/koi/narcissus/content/node_modules/crypto-key-composer/es/formats/pkcs8/keys.js"],"names":["decomposeRsaPrivateKey","composeRsaPrivateKey","decodeAsn1","encodeAsn1","EcParameters","EcPrivateKey","CurvePrivateKey","decodeEcPoint","encodeEcPoint","validateEcD","hexStringToUint8Array","UnsupportedAlgorithmError","OIDS","FLIPPED_OIDS","KEY_TYPES","decomposeRsaPrivateKeyInfo","privateKeyInfo","privateKeyAlgorithm","privateKey","privateKeyAsn1","keyAlgorithm","id","keyData","composeRsaPrivateKeyInfo","rsaPrivateKeyAsn1","version","parameters","decomposeEcPrivateKeyInfo","ecParameters","ecPrivateKey","type","publicKey","namedCurve","value","x","y","data","d","composeEcPrivateKeyInfo","namedCurveOid","unused","ecPrivateKeyAsn1","ecParametersAsn1","decomposeEd25519PrivateKeyInfo","seed","composeEd25519PrivateKeyInfo","decomposePrivateKeyInfo","keyType","composePrivateKeyInfo"],"mappings":"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","sourcesContent":["import { decomposeRsaPrivateKey, composeRsaPrivateKey } from '../raw/keys';\nimport { decodeAsn1, encodeAsn1 } from '../../util/asn1-encoder';\nimport { EcParameters, EcPrivateKey, CurvePrivateKey } from '../../util/asn1-entities';\nimport { decodeEcPoint, encodeEcPoint, validateEcD } from '../../util/ec';\nimport { hexStringToUint8Array } from '../../util/binary';\nimport { UnsupportedAlgorithmError } from '../../util/errors';\nimport { OIDS, FLIPPED_OIDS } from '../../util/oids';\nimport { KEY_TYPES } from '../../util/key-types';\n\nconst decomposeRsaPrivateKeyInfo = privateKeyInfo => {\n  const {\n    privateKeyAlgorithm,\n    privateKey: privateKeyAsn1\n  } = privateKeyInfo;\n  const keyAlgorithm = {\n    id: OIDS[privateKeyAlgorithm.id]\n  };\n\n  switch (keyAlgorithm.id) {\n    case 'rsa-encryption':\n    case 'md2-with-rsa-encryption':\n    case 'md4-with-rsa-encryption':\n    case 'md5-with-rsa-encryption':\n    case 'sha1-with-rsa-encryption':\n    case 'sha224-with-rsa-encryption':\n    case 'sha256-with-rsa-encryption':\n    case 'sha384-with-rsa-encryption':\n    case 'sha512-with-rsa-encryption':\n    case 'sha512-224-with-rsa-encryption':\n    case 'sha512-256-with-rsa-encryption':\n      break;\n\n    /* istanbul ignore next */\n\n    case 'rsaes-oaep':\n      throw new UnsupportedAlgorithmError('RSA-OAEP keys are not yet supported');\n\n    /* istanbul ignore next */\n\n    case 'rsassa-pss':\n      throw new UnsupportedAlgorithmError('RSA-PSS keys are not yet supported');\n\n    /* istanbul ignore next */\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key algorithm OID '${privateKeyAlgorithm.id}'`);\n  }\n\n  const {\n    keyData\n  } = decomposeRsaPrivateKey(privateKeyAsn1);\n  return {\n    keyAlgorithm: {\n      id: OIDS[privateKeyAlgorithm.id]\n    },\n    keyData\n  };\n};\n\nconst composeRsaPrivateKeyInfo = (keyAlgorithm, keyData) => {\n  const rsaPrivateKeyAsn1 = composeRsaPrivateKey(keyAlgorithm, keyData);\n  return {\n    version: 0,\n    privateKeyAlgorithm: {\n      id: FLIPPED_OIDS[keyAlgorithm.id],\n      parameters: hexStringToUint8Array('0500')\n    },\n    privateKey: rsaPrivateKeyAsn1\n  };\n};\n\nconst decomposeEcPrivateKeyInfo = privateKeyInfo => {\n  const {\n    privateKeyAlgorithm,\n    privateKey: privateKeyAsn1\n  } = privateKeyInfo;\n  const ecParameters = decodeAsn1(privateKeyAlgorithm.parameters, EcParameters);\n  const ecPrivateKey = decodeAsn1(privateKeyAsn1, EcPrivateKey); // Validate parameters & publicKey\n\n  /* istanbul ignore if */\n\n  if (ecParameters.type !== 'namedCurve') {\n    throw new UnsupportedAlgorithmError('Only EC named curves are supported');\n  }\n  /* istanbul ignore if */\n\n\n  if (!ecPrivateKey.publicKey) {\n    throw new UnsupportedAlgorithmError('Missing publicKey from ECPrivateKey');\n  } // Ensure that the named curve is supported\n\n\n  const namedCurve = OIDS[ecParameters.value];\n\n  if (!namedCurve) {\n    throw new UnsupportedAlgorithmError(`Unsupported named curve OID '${ecParameters.value}'`);\n  } // Validate & get encoded point\n\n\n  const {\n    x,\n    y\n  } = decodeEcPoint(namedCurve, ecPrivateKey.publicKey.data);\n  return {\n    keyAlgorithm: {\n      id: 'ec-public-key',\n      namedCurve\n    },\n    keyData: {\n      d: ecPrivateKey.privateKey,\n      x,\n      y\n    }\n  };\n};\n\nconst composeEcPrivateKeyInfo = (keyAlgorithm, keyData) => {\n  // Validate named curve\n  const namedCurveOid = FLIPPED_OIDS[keyAlgorithm.namedCurve];\n\n  if (!namedCurveOid) {\n    throw new UnsupportedAlgorithmError(`Unsupported named curve '${keyAlgorithm.namedCurve}'`);\n  } // Validate D value (private key)\n\n\n  const privateKey = validateEcD(keyAlgorithm.namedCurve, keyData.d); // Validate & encode point (public key)\n\n  const publicKey = encodeEcPoint(keyAlgorithm.namedCurve, keyData.x, keyData.y);\n  const ecPrivateKey = {\n    version: 1,\n    privateKey,\n    publicKey: {\n      unused: 0,\n      data: publicKey\n    }\n  };\n  const ecPrivateKeyAsn1 = encodeAsn1(ecPrivateKey, EcPrivateKey);\n  const ecParametersAsn1 = encodeAsn1({\n    type: 'namedCurve',\n    value: namedCurveOid\n  }, EcParameters);\n  return {\n    version: 0,\n    privateKeyAlgorithm: {\n      id: FLIPPED_OIDS[keyAlgorithm.id],\n      parameters: ecParametersAsn1\n    },\n    privateKey: ecPrivateKeyAsn1\n  };\n};\n\nconst decomposeEd25519PrivateKeyInfo = privateKeyInfo => {\n  // See: https://tools.ietf.org/html/rfc8032#section-5.1.5\n  const {\n    privateKeyAlgorithm,\n    privateKey\n  } = privateKeyInfo;\n  const seed = decodeAsn1(privateKey, CurvePrivateKey);\n  return {\n    keyAlgorithm: {\n      id: OIDS[privateKeyAlgorithm.id]\n    },\n    keyData: {\n      seed\n    }\n  };\n};\n\nconst composeEd25519PrivateKeyInfo = (keyAlgorithm, keyData) => ({\n  version: 0,\n  privateKeyAlgorithm: {\n    id: FLIPPED_OIDS[keyAlgorithm.id]\n  },\n  privateKey: encodeAsn1(keyData.seed, CurvePrivateKey)\n});\n\nexport const decomposePrivateKeyInfo = privateKeyInfo => {\n  const keyType = KEY_TYPES[OIDS[privateKeyInfo.privateKeyAlgorithm.id]];\n\n  switch (keyType) {\n    case 'rsa':\n      return decomposeRsaPrivateKeyInfo(privateKeyInfo);\n\n    case 'ec':\n      return decomposeEcPrivateKeyInfo(privateKeyInfo);\n\n    case 'ed25519':\n      return decomposeEd25519PrivateKeyInfo(privateKeyInfo);\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key algorithm OID '${privateKeyInfo.privateKeyAlgorithm.id}'`);\n  }\n};\nexport const composePrivateKeyInfo = (keyAlgorithm, keyData) => {\n  const keyType = KEY_TYPES[keyAlgorithm.id];\n\n  switch (keyType) {\n    case 'rsa':\n      return composeRsaPrivateKeyInfo(keyAlgorithm, keyData);\n\n    case 'ec':\n      return composeEcPrivateKeyInfo(keyAlgorithm, keyData);\n\n    case 'ed25519':\n      return composeEd25519PrivateKeyInfo(keyAlgorithm, keyData);\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key algorithm id '${keyAlgorithm.id}'`);\n  }\n};"]},"metadata":{},"sourceType":"module"}