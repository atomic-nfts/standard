{"ast":null,"code":"var asn = require('asn1.js');\n\nvar crypto = require('crypto');\n\nvar BN = asn.bignum;\nvar zero = new BN(0);\nvar one = new BN(1);\nvar two = new BN(2);\n\nfunction rand(low, high) {\n  do {\n    var b = new BN(crypto.randomBytes(high.byteLength()));\n  } while (b.cmp(low) <= 0 || b.cmp(high) >= 0);\n\n  return b;\n}\n\nfunction odd(n) {\n  if (n.cmp(zero) === 0) {\n    return zero;\n  }\n\n  var r = n;\n\n  while (r.isEven()) {\n    r = r.div(two);\n  }\n\n  return r;\n}\n\nfunction rootOne(x, r, n) {\n  var i = x.toRed(BN.red(n)).redPow(r).fromRed();\n  var o = zero;\n\n  while (i.cmp(one) !== 0) {\n    o = i;\n    i = i.mul(i).mod(n);\n  }\n\n  if (o.cmp(n.sub(one)) === 0) {\n    return zero;\n  }\n\n  return o;\n}\n\nfunction factor(e, d, n) {\n  var k = e.mul(d).sub(one);\n  var r = odd(k);\n\n  do {\n    var y = rootOne(rand(two, n), r, n);\n  } while (y.cmp(zero) === 0);\n\n  var p = y.sub(one).gcd(n);\n  return {\n    p: p,\n    q: n.div(p)\n  };\n}\n\nmodule.exports = factor;","map":{"version":3,"sources":["/home/al/Desktop/koi/narcissus/content/node_modules/pem-jwk/factor.js"],"names":["asn","require","crypto","BN","bignum","zero","one","two","rand","low","high","b","randomBytes","byteLength","cmp","odd","n","r","isEven","div","rootOne","x","i","toRed","red","redPow","fromRed","o","mul","mod","sub","factor","e","d","k","y","p","gcd","q","module","exports"],"mappings":"AAAA,IAAIA,GAAG,GAAGC,OAAO,CAAC,SAAD,CAAjB;;AACA,IAAIC,MAAM,GAAGD,OAAO,CAAC,QAAD,CAApB;;AACA,IAAIE,EAAE,GAAGH,GAAG,CAACI,MAAb;AAEA,IAAIC,IAAI,GAAG,IAAIF,EAAJ,CAAO,CAAP,CAAX;AACA,IAAIG,GAAG,GAAG,IAAIH,EAAJ,CAAO,CAAP,CAAV;AACA,IAAII,GAAG,GAAG,IAAIJ,EAAJ,CAAO,CAAP,CAAV;;AAEA,SAASK,IAAT,CAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACvB,KAAG;AACD,QAAIC,CAAC,GAAG,IAAIR,EAAJ,CAAOD,MAAM,CAACU,WAAP,CAAmBF,IAAI,CAACG,UAAL,EAAnB,CAAP,CAAR;AACD,GAFD,QAEQF,CAAC,CAACG,GAAF,CAAML,GAAN,KAAc,CAAd,IAAmBE,CAAC,CAACG,GAAF,CAAMJ,IAAN,KAAe,CAF1C;;AAGA,SAAOC,CAAP;AACD;;AAED,SAASI,GAAT,CAAaC,CAAb,EAAgB;AACd,MAAIA,CAAC,CAACF,GAAF,CAAMT,IAAN,MAAgB,CAApB,EAAuB;AAAE,WAAOA,IAAP;AAAa;;AACtC,MAAIY,CAAC,GAAGD,CAAR;;AACA,SAAOC,CAAC,CAACC,MAAF,EAAP,EAAmB;AACjBD,IAAAA,CAAC,GAAGA,CAAC,CAACE,GAAF,CAAMZ,GAAN,CAAJ;AACD;;AACD,SAAOU,CAAP;AACD;;AAED,SAASG,OAAT,CAAiBC,CAAjB,EAAoBJ,CAApB,EAAuBD,CAAvB,EAA0B;AACxB,MAAIM,CAAC,GAAGD,CAAC,CAACE,KAAF,CAAQpB,EAAE,CAACqB,GAAH,CAAOR,CAAP,CAAR,EAAmBS,MAAnB,CAA0BR,CAA1B,EAA6BS,OAA7B,EAAR;AACA,MAAIC,CAAC,GAAGtB,IAAR;;AACA,SAAOiB,CAAC,CAACR,GAAF,CAAMR,GAAN,MAAe,CAAtB,EAAyB;AACvBqB,IAAAA,CAAC,GAAGL,CAAJ;AACAA,IAAAA,CAAC,GAAGA,CAAC,CAACM,GAAF,CAAMN,CAAN,EAASO,GAAT,CAAab,CAAb,CAAJ;AACD;;AACD,MAAIW,CAAC,CAACb,GAAF,CAAME,CAAC,CAACc,GAAF,CAAMxB,GAAN,CAAN,MAAsB,CAA1B,EAA6B;AAC3B,WAAOD,IAAP;AACD;;AACD,SAAOsB,CAAP;AACD;;AAED,SAASI,MAAT,CAAgBC,CAAhB,EAAmBC,CAAnB,EAAsBjB,CAAtB,EAAyB;AACvB,MAAIkB,CAAC,GAAGF,CAAC,CAACJ,GAAF,CAAMK,CAAN,EAASH,GAAT,CAAaxB,GAAb,CAAR;AACA,MAAIW,CAAC,GAAGF,GAAG,CAACmB,CAAD,CAAX;;AACA,KAAG;AACD,QAAIC,CAAC,GAAGf,OAAO,CAACZ,IAAI,CAACD,GAAD,EAAMS,CAAN,CAAL,EAAeC,CAAf,EAAkBD,CAAlB,CAAf;AACD,GAFD,QAESmB,CAAC,CAACrB,GAAF,CAAMT,IAAN,MAAgB,CAFzB;;AAIA,MAAI+B,CAAC,GAAGD,CAAC,CAACL,GAAF,CAAMxB,GAAN,EAAW+B,GAAX,CAAerB,CAAf,CAAR;AACA,SAAO;AACLoB,IAAAA,CAAC,EAAEA,CADE;AAELE,IAAAA,CAAC,EAAEtB,CAAC,CAACG,GAAF,CAAMiB,CAAN;AAFE,GAAP;AAID;;AAEDG,MAAM,CAACC,OAAP,GAAiBT,MAAjB","sourcesContent":["var asn = require('asn1.js')\nvar crypto = require('crypto')\nvar BN = asn.bignum\n\nvar zero = new BN(0)\nvar one = new BN(1)\nvar two = new BN(2)\n\nfunction rand(low, high) {\n  do {\n    var b = new BN(crypto.randomBytes(high.byteLength()))\n  } while(b.cmp(low) <= 0 || b.cmp(high) >= 0)\n  return b\n}\n\nfunction odd(n) {\n  if (n.cmp(zero) === 0) { return zero }\n  var r = n\n  while (r.isEven()) {\n    r = r.div(two)\n  }\n  return r\n}\n\nfunction rootOne(x, r, n) {\n  var i = x.toRed(BN.red(n)).redPow(r).fromRed()\n  var o = zero\n  while (i.cmp(one) !== 0) {\n    o = i\n    i = i.mul(i).mod(n)\n  }\n  if (o.cmp(n.sub(one)) === 0) {\n    return zero\n  }\n  return o\n}\n\nfunction factor(e, d, n) {\n  var k = e.mul(d).sub(one)\n  var r = odd(k)\n  do {\n    var y = rootOne(rand(two, n), r, n)\n  } while (y.cmp(zero) === 0)\n\n  var p = y.sub(one).gcd(n)\n  return {\n    p: p,\n    q: n.div(p)\n  }\n}\n\nmodule.exports = factor\n"]},"metadata":{},"sourceType":"script"}