{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar axios_1 = __importDefault(require(\"axios\"));\n\nvar Api = /*#__PURE__*/function () {\n  function Api(config) {\n    _classCallCheck(this, Api);\n\n    this.METHOD_GET = \"GET\";\n    this.METHOD_POST = \"POST\";\n    this.applyConfig(config);\n  }\n\n  _createClass(Api, [{\n    key: \"applyConfig\",\n    value: function applyConfig(config) {\n      this.config = this.mergeDefaults(config);\n    }\n  }, {\n    key: \"getConfig\",\n    value: function getConfig() {\n      return this.config;\n    }\n  }, {\n    key: \"mergeDefaults\",\n    value: function mergeDefaults(config) {\n      var protocol = config.protocol || \"http\";\n      var port = config.port || (protocol === \"https\" ? 443 : 80);\n      return {\n        host: config.host || \"127.0.0.1\",\n        protocol: protocol,\n        port: port,\n        timeout: config.timeout || 20000,\n        logging: config.logging || false,\n        logger: config.logger || console.log\n      };\n    }\n  }, {\n    key: \"get\",\n    value: function () {\n      var _get = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(endpoint, config) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.request().get(endpoint, config);\n\n              case 3:\n                return _context.abrupt(\"return\", _context.sent);\n\n              case 6:\n                _context.prev = 6;\n                _context.t0 = _context[\"catch\"](0);\n\n                if (!(_context.t0.response && _context.t0.response.status)) {\n                  _context.next = 10;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", _context.t0.response);\n\n              case 10:\n                throw _context.t0;\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 6]]);\n      }));\n\n      function get(_x, _x2) {\n        return _get.apply(this, arguments);\n      }\n\n      return get;\n    }()\n  }, {\n    key: \"post\",\n    value: function () {\n      var _post = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(endpoint, body, config) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return this.request().post(endpoint, body, config);\n\n              case 3:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 6:\n                _context2.prev = 6;\n                _context2.t0 = _context2[\"catch\"](0);\n\n                if (!(_context2.t0.response && _context2.t0.response.status)) {\n                  _context2.next = 10;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _context2.t0.response);\n\n              case 10:\n                throw _context2.t0;\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 6]]);\n      }));\n\n      function post(_x3, _x4, _x5) {\n        return _post.apply(this, arguments);\n      }\n\n      return post;\n    }()\n    /**\n     * Get an AxiosInstance with the base configuration setup to fire off\n     * a request to the network.\n     */\n\n  }, {\n    key: \"request\",\n    value: function request() {\n      var _this = this;\n\n      var instance = axios_1.default.create({\n        baseURL: \"\".concat(this.config.protocol, \"://\").concat(this.config.host, \":\").concat(this.config.port),\n        timeout: this.config.timeout,\n        maxContentLength: 1024 * 1024 * 512\n      });\n\n      if (this.config.logging) {\n        instance.interceptors.request.use(function (request) {\n          _this.config.logger(\"Requesting: \".concat(request.baseURL, \"/\").concat(request.url));\n\n          return request;\n        });\n        instance.interceptors.response.use(function (response) {\n          _this.config.logger(\"Response:   \".concat(response.config.url, \" - \").concat(response.status));\n\n          return response;\n        });\n      }\n\n      return instance;\n    }\n  }]);\n\n  return Api;\n}();\n\nexports.default = Api;","map":{"version":3,"sources":["../../../../src/common/lib/api.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst axios_1 = __importDefault(require(\"axios\"));\nclass Api {\n    constructor(config) {\n        this.METHOD_GET = \"GET\";\n        this.METHOD_POST = \"POST\";\n        this.applyConfig(config);\n    }\n    applyConfig(config) {\n        this.config = this.mergeDefaults(config);\n    }\n    getConfig() {\n        return this.config;\n    }\n    mergeDefaults(config) {\n        const protocol = config.protocol || \"http\";\n        const port = config.port || (protocol === \"https\" ? 443 : 80);\n        return {\n            host: config.host || \"127.0.0.1\",\n            protocol,\n            port,\n            timeout: config.timeout || 20000,\n            logging: config.logging || false,\n            logger: config.logger || console.log,\n        };\n    }\n    async get(endpoint, config) {\n        try {\n            return await this.request().get(endpoint, config);\n        }\n        catch (error) {\n            if (error.response && error.response.status) {\n                return error.response;\n            }\n            throw error;\n        }\n    }\n    async post(endpoint, body, config) {\n        try {\n            return await this.request().post(endpoint, body, config);\n        }\n        catch (error) {\n            if (error.response && error.response.status) {\n                return error.response;\n            }\n            throw error;\n        }\n    }\n    /**\n     * Get an AxiosInstance with the base configuration setup to fire off\n     * a request to the network.\n     */\n    request() {\n        let instance = axios_1.default.create({\n            baseURL: `${this.config.protocol}://${this.config.host}:${this.config.port}`,\n            timeout: this.config.timeout,\n            maxContentLength: 1024 * 1024 * 512,\n        });\n        if (this.config.logging) {\n            instance.interceptors.request.use((request) => {\n                this.config.logger(`Requesting: ${request.baseURL}/${request.url}`);\n                return request;\n            });\n            instance.interceptors.response.use((response) => {\n                this.config.logger(`Response:   ${response.config.url} - ${response.status}`);\n                return response;\n            });\n        }\n        return instance;\n    }\n}\nexports.default = Api;\n//# sourceMappingURL=api.js.map"]},"metadata":{},"sourceType":"script"}