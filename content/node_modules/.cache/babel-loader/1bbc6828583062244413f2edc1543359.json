{"ast":null,"code":"import _objectSpread from \"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"/home/al/Desktop/koi/narcissus/content/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"version\"],\n    _excluded2 = [\"version\"];\nimport { decodeAsn1, encodeAsn1 } from '../../util/asn1-encoder';\nimport { RsaPrivateKey, RsaPublicKey, EcPrivateKey } from '../../util/asn1-entities';\nimport { decodeEcPoint, encodeEcPoint, validateEcD } from '../../util/ec';\nimport { UnsupportedAlgorithmError } from '../../util/errors';\nimport { OIDS, FLIPPED_OIDS } from '../../util/oids';\nimport { KEY_TYPES } from '../../util/key-types';\nexport var SUPPORTED_KEY_TYPES = {\n  private: ['rsa', 'ec'],\n  public: ['rsa']\n};\nexport var decomposeRsaPrivateKey = function decomposeRsaPrivateKey(rsaPrivateKeyAsn1) {\n  var _decodeAsn = decodeAsn1(rsaPrivateKeyAsn1, RsaPrivateKey),\n      version = _decodeAsn.version,\n      keyData = _objectWithoutProperties(_decodeAsn, _excluded);\n\n  return {\n    keyAlgorithm: {\n      id: 'rsa-encryption'\n    },\n    keyData: keyData\n  };\n};\nexport var composeRsaPrivateKey = function composeRsaPrivateKey(keyAlgorithm, keyData) {\n  var otherPrimeInfos = keyData.otherPrimeInfos;\n  var hasMultiplePrimes = otherPrimeInfos && otherPrimeInfos.length > 0;\n\n  var rsaPrivateKey = _objectSpread(_objectSpread({}, keyData), {}, {\n    version: hasMultiplePrimes ? 1 : 0,\n    otherPrimeInfos: hasMultiplePrimes ? otherPrimeInfos : undefined\n  });\n\n  return encodeAsn1(rsaPrivateKey, RsaPrivateKey);\n};\nexport var decomposeRsaPublicKey = function decomposeRsaPublicKey(rsaPublicKeyAsn1) {\n  var _decodeAsn2 = decodeAsn1(rsaPublicKeyAsn1, RsaPublicKey),\n      version = _decodeAsn2.version,\n      keyData = _objectWithoutProperties(_decodeAsn2, _excluded2);\n\n  return {\n    keyAlgorithm: {\n      id: 'rsa-encryption'\n    },\n    keyData: keyData\n  };\n};\nexport var composeRsaPublicKey = function composeRsaPublicKey(keyAlgorithm, keyData) {\n  return encodeAsn1(keyData, RsaPublicKey);\n};\nexport var decomposeEcPrivateKey = function decomposeEcPrivateKey(ecPrivateKeyAsn1) {\n  var ecPrivateKey = decodeAsn1(ecPrivateKeyAsn1, EcPrivateKey); // Validate parameters & publicKey\n\n  /* istanbul ignore if */\n\n  if (!ecPrivateKey.parameters) {\n    throw new UnsupportedAlgorithmError('Missing parameters from ECPrivateKey');\n  }\n  /* istanbul ignore if */\n\n\n  if (ecPrivateKey.parameters.type !== 'namedCurve') {\n    throw new UnsupportedAlgorithmError('Only EC named curves are supported');\n  }\n  /* istanbul ignore if */\n\n\n  if (!ecPrivateKey.publicKey) {\n    throw new UnsupportedAlgorithmError('Missing publicKey from ECPrivateKey');\n  } // Ensure that the named curve is supported\n\n\n  var namedCurve = OIDS[ecPrivateKey.parameters.value];\n\n  if (!namedCurve) {\n    throw new UnsupportedAlgorithmError(\"Unsupported named curve OID '\".concat(ecPrivateKey.parameters.value, \"'\"));\n  } // Validate & encode point (public key)\n\n\n  var _decodeEcPoint = decodeEcPoint(namedCurve, ecPrivateKey.publicKey.data),\n      x = _decodeEcPoint.x,\n      y = _decodeEcPoint.y;\n\n  return {\n    keyAlgorithm: {\n      id: 'ec-public-key',\n      namedCurve: namedCurve\n    },\n    keyData: {\n      d: ecPrivateKey.privateKey,\n      x: x,\n      y: y\n    }\n  };\n};\nexport var composeEcPrivateKey = function composeEcPrivateKey(keyAlgorithm, keyData) {\n  // Validate named curve\n  var namedCurveOid = FLIPPED_OIDS[keyAlgorithm.namedCurve];\n\n  if (!namedCurveOid) {\n    throw new UnsupportedAlgorithmError(\"Unsupported named curve '\".concat(keyAlgorithm.namedCurve, \"'\"));\n  } // Validate D value (private key)\n\n\n  var privateKey = validateEcD(keyAlgorithm.namedCurve, keyData.d); // Encode point (public key)\n\n  var publicKey = encodeEcPoint(keyAlgorithm.namedCurve, keyData.x, keyData.y);\n  var ecPrivateKey = {\n    version: 1,\n    privateKey: privateKey,\n    parameters: {\n      type: 'namedCurve',\n      value: namedCurveOid\n    },\n    publicKey: {\n      unused: 0,\n      data: publicKey\n    }\n  };\n  return encodeAsn1(ecPrivateKey, EcPrivateKey);\n};\nexport var decomposeRawPrivateKey = function decomposeRawPrivateKey(keyType, privateKeyAsn1) {\n  switch (keyType) {\n    case 'rsa':\n      return decomposeRsaPrivateKey(privateKeyAsn1);\n\n    case 'ec':\n      return decomposeEcPrivateKey(privateKeyAsn1);\n\n    default:\n      throw new UnsupportedAlgorithmError(\"Unsupported key type '\".concat(keyType, \"'\"));\n  }\n};\nexport var composeRawPrivateKey = function composeRawPrivateKey(keyAlgorithm, keyData) {\n  var keyType = KEY_TYPES[keyAlgorithm.id];\n\n  switch (keyType) {\n    case 'rsa':\n      return composeRsaPrivateKey(keyAlgorithm, keyData);\n\n    case 'ec':\n      return composeEcPrivateKey(keyAlgorithm, keyData);\n\n    default:\n      throw new UnsupportedAlgorithmError(\"Unsupported key algorithm id '\".concat(keyAlgorithm.id, \"'\"));\n  }\n};\nexport var decomposeRawPublicKey = function decomposeRawPublicKey(keyType, publicKeyAsn1) {\n  switch (keyType) {\n    case 'rsa':\n      return decomposeRsaPublicKey(publicKeyAsn1);\n\n    default:\n      throw new UnsupportedAlgorithmError(\"Unsupported key type '\".concat(keyType, \"'\"));\n  }\n};\nexport var composeRawPublicKey = function composeRawPublicKey(keyAlgorithm, keyData) {\n  var keyType = KEY_TYPES[keyAlgorithm.id];\n\n  switch (keyType) {\n    case 'rsa':\n      return composeRsaPublicKey(keyAlgorithm, keyData);\n\n    default:\n      throw new UnsupportedAlgorithmError(\"Unsupported key algorithm id '\".concat(keyAlgorithm.id, \"'\"));\n  }\n};","map":{"version":3,"sources":["/home/al/Desktop/koi/narcissus/content/node_modules/crypto-key-composer/es/formats/raw/keys.js"],"names":["decodeAsn1","encodeAsn1","RsaPrivateKey","RsaPublicKey","EcPrivateKey","decodeEcPoint","encodeEcPoint","validateEcD","UnsupportedAlgorithmError","OIDS","FLIPPED_OIDS","KEY_TYPES","SUPPORTED_KEY_TYPES","private","public","decomposeRsaPrivateKey","rsaPrivateKeyAsn1","version","keyData","keyAlgorithm","id","composeRsaPrivateKey","otherPrimeInfos","hasMultiplePrimes","length","rsaPrivateKey","undefined","decomposeRsaPublicKey","rsaPublicKeyAsn1","composeRsaPublicKey","decomposeEcPrivateKey","ecPrivateKeyAsn1","ecPrivateKey","parameters","type","publicKey","namedCurve","value","data","x","y","d","privateKey","composeEcPrivateKey","namedCurveOid","unused","decomposeRawPrivateKey","keyType","privateKeyAsn1","composeRawPrivateKey","decomposeRawPublicKey","publicKeyAsn1","composeRawPublicKey"],"mappings":"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","sourcesContent":["import { decodeAsn1, encodeAsn1 } from '../../util/asn1-encoder';\nimport { RsaPrivateKey, RsaPublicKey, EcPrivateKey } from '../../util/asn1-entities';\nimport { decodeEcPoint, encodeEcPoint, validateEcD } from '../../util/ec';\nimport { UnsupportedAlgorithmError } from '../../util/errors';\nimport { OIDS, FLIPPED_OIDS } from '../../util/oids';\nimport { KEY_TYPES } from '../../util/key-types';\nexport const SUPPORTED_KEY_TYPES = {\n  private: ['rsa', 'ec'],\n  public: ['rsa']\n};\nexport const decomposeRsaPrivateKey = rsaPrivateKeyAsn1 => {\n  const {\n    version,\n    ...keyData\n  } = decodeAsn1(rsaPrivateKeyAsn1, RsaPrivateKey);\n  return {\n    keyAlgorithm: {\n      id: 'rsa-encryption'\n    },\n    keyData\n  };\n};\nexport const composeRsaPrivateKey = (keyAlgorithm, keyData) => {\n  const otherPrimeInfos = keyData.otherPrimeInfos;\n  const hasMultiplePrimes = otherPrimeInfos && otherPrimeInfos.length > 0;\n  const rsaPrivateKey = { ...keyData,\n    version: hasMultiplePrimes ? 1 : 0,\n    otherPrimeInfos: hasMultiplePrimes ? otherPrimeInfos : undefined\n  };\n  return encodeAsn1(rsaPrivateKey, RsaPrivateKey);\n};\nexport const decomposeRsaPublicKey = rsaPublicKeyAsn1 => {\n  const {\n    version,\n    ...keyData\n  } = decodeAsn1(rsaPublicKeyAsn1, RsaPublicKey);\n  return {\n    keyAlgorithm: {\n      id: 'rsa-encryption'\n    },\n    keyData\n  };\n};\nexport const composeRsaPublicKey = (keyAlgorithm, keyData) => encodeAsn1(keyData, RsaPublicKey);\nexport const decomposeEcPrivateKey = ecPrivateKeyAsn1 => {\n  const ecPrivateKey = decodeAsn1(ecPrivateKeyAsn1, EcPrivateKey); // Validate parameters & publicKey\n\n  /* istanbul ignore if */\n\n  if (!ecPrivateKey.parameters) {\n    throw new UnsupportedAlgorithmError('Missing parameters from ECPrivateKey');\n  }\n  /* istanbul ignore if */\n\n\n  if (ecPrivateKey.parameters.type !== 'namedCurve') {\n    throw new UnsupportedAlgorithmError('Only EC named curves are supported');\n  }\n  /* istanbul ignore if */\n\n\n  if (!ecPrivateKey.publicKey) {\n    throw new UnsupportedAlgorithmError('Missing publicKey from ECPrivateKey');\n  } // Ensure that the named curve is supported\n\n\n  const namedCurve = OIDS[ecPrivateKey.parameters.value];\n\n  if (!namedCurve) {\n    throw new UnsupportedAlgorithmError(`Unsupported named curve OID '${ecPrivateKey.parameters.value}'`);\n  } // Validate & encode point (public key)\n\n\n  const {\n    x,\n    y\n  } = decodeEcPoint(namedCurve, ecPrivateKey.publicKey.data);\n  return {\n    keyAlgorithm: {\n      id: 'ec-public-key',\n      namedCurve\n    },\n    keyData: {\n      d: ecPrivateKey.privateKey,\n      x,\n      y\n    }\n  };\n};\nexport const composeEcPrivateKey = (keyAlgorithm, keyData) => {\n  // Validate named curve\n  const namedCurveOid = FLIPPED_OIDS[keyAlgorithm.namedCurve];\n\n  if (!namedCurveOid) {\n    throw new UnsupportedAlgorithmError(`Unsupported named curve '${keyAlgorithm.namedCurve}'`);\n  } // Validate D value (private key)\n\n\n  const privateKey = validateEcD(keyAlgorithm.namedCurve, keyData.d); // Encode point (public key)\n\n  const publicKey = encodeEcPoint(keyAlgorithm.namedCurve, keyData.x, keyData.y);\n  const ecPrivateKey = {\n    version: 1,\n    privateKey,\n    parameters: {\n      type: 'namedCurve',\n      value: namedCurveOid\n    },\n    publicKey: {\n      unused: 0,\n      data: publicKey\n    }\n  };\n  return encodeAsn1(ecPrivateKey, EcPrivateKey);\n};\nexport const decomposeRawPrivateKey = (keyType, privateKeyAsn1) => {\n  switch (keyType) {\n    case 'rsa':\n      return decomposeRsaPrivateKey(privateKeyAsn1);\n\n    case 'ec':\n      return decomposeEcPrivateKey(privateKeyAsn1);\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key type '${keyType}'`);\n  }\n};\nexport const composeRawPrivateKey = (keyAlgorithm, keyData) => {\n  const keyType = KEY_TYPES[keyAlgorithm.id];\n\n  switch (keyType) {\n    case 'rsa':\n      return composeRsaPrivateKey(keyAlgorithm, keyData);\n\n    case 'ec':\n      return composeEcPrivateKey(keyAlgorithm, keyData);\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key algorithm id '${keyAlgorithm.id}'`);\n  }\n};\nexport const decomposeRawPublicKey = (keyType, publicKeyAsn1) => {\n  switch (keyType) {\n    case 'rsa':\n      return decomposeRsaPublicKey(publicKeyAsn1);\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key type '${keyType}'`);\n  }\n};\nexport const composeRawPublicKey = (keyAlgorithm, keyData) => {\n  const keyType = KEY_TYPES[keyAlgorithm.id];\n\n  switch (keyType) {\n    case 'rsa':\n      return composeRsaPublicKey(keyAlgorithm, keyData);\n\n    default:\n      throw new UnsupportedAlgorithmError(`Unsupported key algorithm id '${keyAlgorithm.id}'`);\n  }\n};"]},"metadata":{},"sourceType":"module"}