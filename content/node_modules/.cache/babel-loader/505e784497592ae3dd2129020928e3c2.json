{"ast":null,"code":"import { decomposeRsaPrivateKey, composeRsaPrivateKey } from '../raw/keys';\nimport { UnsupportedAlgorithmError, DecodeAsn1FailedError } from '../../util/errors';\nimport { KEY_TYPES } from '../../util/key-types';\nexport const decomposePrivateKey = rsaPrivateKeyAsn1 => {\n  let decomposedRsaKey;\n\n  try {\n    decomposedRsaKey = decomposeRsaPrivateKey(rsaPrivateKeyAsn1);\n  } catch (err) {\n    err.invalidInputKey = err instanceof DecodeAsn1FailedError;\n    throw err;\n  }\n\n  const {\n    keyAlgorithm,\n    keyData\n  } = decomposedRsaKey;\n  return {\n    format: 'pkcs1-der',\n    encryptionAlgorithm: null,\n    keyAlgorithm,\n    keyData\n  };\n};\nexport const composePrivateKey = ({\n  keyAlgorithm,\n  keyData,\n  encryptionAlgorithm\n}) => {\n  const keyType = KEY_TYPES[keyAlgorithm.id];\n\n  if (keyType !== 'rsa') {\n    throw new UnsupportedAlgorithmError('The key algorithm id for PKCS1 must be one of RSA\\'s');\n  }\n\n  if (encryptionAlgorithm) {\n    throw new UnsupportedAlgorithmError('The PKCS1 DER format does not support encryption');\n  }\n\n  return composeRsaPrivateKey(keyAlgorithm, keyData);\n};","map":{"version":3,"sources":["/home/al/Desktop/koi/narcissus/content/node_modules/crypto-key-composer/es/formats/pkcs1/pkcs1-der.js"],"names":["decomposeRsaPrivateKey","composeRsaPrivateKey","UnsupportedAlgorithmError","DecodeAsn1FailedError","KEY_TYPES","decomposePrivateKey","rsaPrivateKeyAsn1","decomposedRsaKey","err","invalidInputKey","keyAlgorithm","keyData","format","encryptionAlgorithm","composePrivateKey","keyType","id"],"mappings":"AAAA,SAASA,sBAAT,EAAiCC,oBAAjC,QAA6D,aAA7D;AACA,SAASC,yBAAT,EAAoCC,qBAApC,QAAiE,mBAAjE;AACA,SAASC,SAAT,QAA0B,sBAA1B;AACA,OAAO,MAAMC,mBAAmB,GAAGC,iBAAiB,IAAI;AACtD,MAAIC,gBAAJ;;AAEA,MAAI;AACFA,IAAAA,gBAAgB,GAAGP,sBAAsB,CAACM,iBAAD,CAAzC;AACD,GAFD,CAEE,OAAOE,GAAP,EAAY;AACZA,IAAAA,GAAG,CAACC,eAAJ,GAAsBD,GAAG,YAAYL,qBAArC;AACA,UAAMK,GAAN;AACD;;AAED,QAAM;AACJE,IAAAA,YADI;AAEJC,IAAAA;AAFI,MAGFJ,gBAHJ;AAIA,SAAO;AACLK,IAAAA,MAAM,EAAE,WADH;AAELC,IAAAA,mBAAmB,EAAE,IAFhB;AAGLH,IAAAA,YAHK;AAILC,IAAAA;AAJK,GAAP;AAMD,CApBM;AAqBP,OAAO,MAAMG,iBAAiB,GAAG,CAAC;AAChCJ,EAAAA,YADgC;AAEhCC,EAAAA,OAFgC;AAGhCE,EAAAA;AAHgC,CAAD,KAI3B;AACJ,QAAME,OAAO,GAAGX,SAAS,CAACM,YAAY,CAACM,EAAd,CAAzB;;AAEA,MAAID,OAAO,KAAK,KAAhB,EAAuB;AACrB,UAAM,IAAIb,yBAAJ,CAA8B,sDAA9B,CAAN;AACD;;AAED,MAAIW,mBAAJ,EAAyB;AACvB,UAAM,IAAIX,yBAAJ,CAA8B,kDAA9B,CAAN;AACD;;AAED,SAAOD,oBAAoB,CAACS,YAAD,EAAeC,OAAf,CAA3B;AACD,CAhBM","sourcesContent":["import { decomposeRsaPrivateKey, composeRsaPrivateKey } from '../raw/keys';\nimport { UnsupportedAlgorithmError, DecodeAsn1FailedError } from '../../util/errors';\nimport { KEY_TYPES } from '../../util/key-types';\nexport const decomposePrivateKey = rsaPrivateKeyAsn1 => {\n  let decomposedRsaKey;\n\n  try {\n    decomposedRsaKey = decomposeRsaPrivateKey(rsaPrivateKeyAsn1);\n  } catch (err) {\n    err.invalidInputKey = err instanceof DecodeAsn1FailedError;\n    throw err;\n  }\n\n  const {\n    keyAlgorithm,\n    keyData\n  } = decomposedRsaKey;\n  return {\n    format: 'pkcs1-der',\n    encryptionAlgorithm: null,\n    keyAlgorithm,\n    keyData\n  };\n};\nexport const composePrivateKey = ({\n  keyAlgorithm,\n  keyData,\n  encryptionAlgorithm\n}) => {\n  const keyType = KEY_TYPES[keyAlgorithm.id];\n\n  if (keyType !== 'rsa') {\n    throw new UnsupportedAlgorithmError('The key algorithm id for PKCS1 must be one of RSA\\'s');\n  }\n\n  if (encryptionAlgorithm) {\n    throw new UnsupportedAlgorithmError('The PKCS1 DER format does not support encryption');\n  }\n\n  return composeRsaPrivateKey(keyAlgorithm, keyData);\n};"]},"metadata":{},"sourceType":"module"}