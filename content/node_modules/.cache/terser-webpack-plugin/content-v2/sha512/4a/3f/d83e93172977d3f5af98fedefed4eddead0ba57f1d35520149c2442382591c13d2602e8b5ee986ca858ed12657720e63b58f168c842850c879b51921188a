{"code":"(this.webpackJsonpnarcissus=this.webpackJsonpnarcissus||[]).push([[0],{118:function(e,n){},270:function(e,n,t){},353:function(e,n){},355:function(e,n){},365:function(e,n){},367:function(e,n){},388:function(e,n){},463:function(e,n){},468:function(e,n){},470:function(e,n){},477:function(e,n){},489:function(e,n){},520:function(e,n){},547:function(e,n,t){},551:function(e,n,t){\"use strict\";t.r(n);var r=t(21),c=t.n(r),a=t(253),s=t.n(a),o=(t(270),t(1)),u=t.n(o),i=t(23),l=t(32),f=t(52),p=t(254),d=t(265),g=t.n(d),m=t(59),b=t.n(m),j=(t(547),t(24)),h=new p.Web;console.log(\"ktools\",h);var v=225;var y=function(){var e=Object(r.useState)(Object(j.jsx)(\"canvas\",{})),n=Object(f.a)(e,2),t=n[0],a=n[1],s=Object(r.useState)(!0),o=Object(f.a)(s,2),p=o[0],d=o[1],m=Object(r.useState)(0),h=Object(f.a)(m,2),y=h[0],O=h[1],x=Object(r.useRef)(null);Object(r.useEffect)((function(){w()}),[]),Object(r.useLayoutEffect)((function(){return function(){if(console.log(\"useEffect score\",x,\"score is\",y),x.current){var e=document.createElement(\"span\");e.innerText=y,e.className=\"scoreSpan\",x.current.appendChild(e)}else console.log(\"not updating score because\",x.current)}(),function(){var e,n=document.getElementsByClassName(\"scoreSpan\"),t=Object(l.a)(n);try{for(t.s();!(e=t.n()).done;){e.value.remove()}}catch(r){t.e(r)}finally{t.f()}}}),[y]),Object(r.useLayoutEffect)((function(){if(console.log(\"useEffect\",x),!x.current)return console.log(\"not updating narcissus because\",x.current),void w();console.log(\"about to append because main is\",x.current,t);var e=document.createElement(\"span\");return e.innerText=y,e.className=\"scoreSpan\",t.className=\"narcissus\",x.current.appendChild(t),x.current.appendChild(e),function(){console.log(\"clean up\");var e,n=document.getElementsByClassName(\"narcissus\"),t=Object(l.a)(n);try{for(t.s();!(e=t.n()).done;){e.value.remove()}}catch(r){t.e(r)}finally{t.f()}}}),[t]);var w=function(){var e=Object(i.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return n=e.sent,console.log(\"setting frame\",n),e.next=6,C(n);case 6:return e.abrupt(\"return\",{state:undefined,id:undefined});case 7:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function k(e){return E.apply(this,arguments)}function E(){return(E=Object(i.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get(n);case 3:return t=e.sent,console.log(t),e.abrupt(\"return\",t.data);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case\"end\":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=Object(i.a)(u.a.mark((function e(){var n,t,r,c,a,s,o,i,f,p,d,g,m,b,j,h,y;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=window.location.pathname.split(\"/\")[1]||\"1ZjIecqKGYdGTFMWR9kdGrmi77lMmZnA6dxEzWulyjo\",e.next=4,k(\"https://arweave.net/1ZjIecqKGYdGTFMWR9kdGrmi77lMmZnA6dxEzWulyjo\");case 4:return t=e.sent,e.next=7,k(\"https://arweave.net/cETTyJQYxJLVQ6nC3VxzsZf1x2-6TW2LFkGZa91gUWc\");case 7:r=e.sent,c=t.decay.lockState||0,a=t.decay.lastLock,s=r.stateUpdate.trafficLogs.rewardReport,i=0,f=t.decay.lastMax||1,p=1,d=0,g=0,m=0,b=Object(l.a)(s);try{for(b.s();!(j=b.n()).done;)(h=j.value).dailyTrafficBlock>a&&(h.logsSummary,Object.keys(h.logsSummary).includes(n)&&((y=h.logsSummary[n])<f?(d===m-1&&(p+=p),m-10<g&&(p*=-1),i+=y*(1+p/100)):(f=y,g=m,i+=1e4),d=m)),m+=1}catch(u){b.e(u)}finally{b.f()}return i<1?(console.log(\"returning current\",c),o=c):(o=(v-c)*(10001-i))>v?o=v:o<0&&(o=0),console.log(\"newScore is\",o),O(o),e.abrupt(\"return\",o);case 25:return e.prev=25,e.t0=e.catch(0),console.log(\"error loading nft data\",e.t0),O(1),e.abrupt(\"return\",1);case 30:case\"end\":return e.stop()}}),e,null,[[0,25]])})))).apply(this,arguments)}function C(e){return F.apply(this,arguments)}function F(){return(F=Object(i.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",new Promise((function(e,t){try{g()({url:\"./img/narcissus.gif\",frames:\"0-1000\",outputType:\"canvas\"}).then((function(t){var r=t[n].getImage();a(r),d(!1),e(t)})).catch(console.error.bind(console))}catch(r){console.log(\"err\",r),t(r)}})));case 1:case\"end\":return e.stop()}}),e)})))).apply(this,arguments)}return Object(j.jsxs)(\"div\",{className:\"App\",children:[p&&Object(j.jsx)(\"img\",{alt:\"this is the loading icon\",src:window.location.origin+\"/img/narcissus.gif\"}),!p&&Object(j.jsxs)(c.a.Fragment,{children:[Object(j.jsx)(\"header\",{}),Object(j.jsx)(\"main\",{ref:x}),Object(j.jsx)(\"img\",{src:\"./img/narcissus.gif\"})]})]})},O=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,552)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,a=n.getLCP,s=n.getTTFB;t(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(y,{})}),document.getElementById(\"root\")),O()}},[[551,1,2]]]);","name":"static/js/main.ee1cada0.chunk.js","map":{"version":3,"sources":["static/js/main.ee1cada0.chunk.js"],"names":["this","push","module","exports","__webpack_require__","__webpack_exports__","r","react","react_default","n","react_dom","react_dom_default","regenerator","regenerator_default","asyncToGenerator","createForOfIteratorHelper","slicedToArray","web","gif_frames","gif_frames_default","axios","axios_default","jsx_runtime","ktools","console","log","totalFrames","src_App","_useState","Object","_useState2","narcissus","setNarcissus","_useState3","_useState4","loading","setLoading","_useState5","_useState6","score","setScore","mainRef","init","current","scoreSpan","document","createElement","innerText","className","appendChild","updateScore","_step","spans","getElementsByClassName","_iterator","s","done","value","remove","err","e","f","_step2","narci","_iterator2","_ref","a","mark","_callee","correctFreezeFrame","wrap","_context","prev","next","getCorrectFreezeFrame","sent","setGif","abrupt","state","id","stop","apply","arguments","getData","_x","_getData","_callee2","url","response","_context2","get","data","t0","error","_getCorrectFreezeFrame","_callee3","oid","nft_state","koii_state","lockBlock","list","newScore","change","max","scalar","last","lastMax","i","_iterator3","_step3","item","aScore","_context3","window","location","pathname","split","decay","lockState","lastLock","stateUpdate","trafficLogs","rewardReport","dailyTrafficBlock","logsSummary","keys","includes","_x2","_setGif","_callee4","frameToSet","_context4","Promise","resolve","reject","frames","outputType","then","frameData","obj","getImage","catch","bind","children","alt","src","origin","Fragment","ref","src_reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","render","StrictMode","getElementById"],"mappings":"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"},"input":"(this[\"webpackJsonpnarcissus\"] = this[\"webpackJsonpnarcissus\"] || []).push([[0],{\n\n/***/ 118:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 270:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 353:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 355:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 365:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 367:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 388:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 463:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 468:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 470:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 477:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 489:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 520:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 547:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 551:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(21);\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(253);\nvar react_dom_default = /*#__PURE__*/__webpack_require__.n(react_dom);\n\n// EXTERNAL MODULE: ./src/index.css\nvar src = __webpack_require__(270);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js\nvar regenerator = __webpack_require__(1);\nvar regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\nvar asyncToGenerator = __webpack_require__(23);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\nvar createForOfIteratorHelper = __webpack_require__(32);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 3 modules\nvar slicedToArray = __webpack_require__(52);\n\n// EXTERNAL MODULE: ./node_modules/@_koi/sdk/web.js\nvar web = __webpack_require__(254);\n\n// EXTERNAL MODULE: ./node_modules/gif-frames/gif-frames.js\nvar gif_frames = __webpack_require__(265);\nvar gif_frames_default = /*#__PURE__*/__webpack_require__.n(gif_frames);\n\n// EXTERNAL MODULE: ./node_modules/axios/index.js\nvar axios = __webpack_require__(59);\nvar axios_default = /*#__PURE__*/__webpack_require__.n(axios);\n\n// EXTERNAL MODULE: ./src/App.css\nvar App = __webpack_require__(547);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(24);\n\n// CONCATENATED MODULE: ./src/App.js\n// import SmartWeave from \"smartweave\";\nvar ktools=new web[\"Web\"]();console.log(\"ktools\",ktools);var state;var id;var koii;var totalFrames=225;function App_App(){var _useState=Object(react[\"useState\"])(/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"canvas\",{})),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),narcissus=_useState2[0],setNarcissus=_useState2[1];var _useState3=Object(react[\"useState\"])(true),_useState4=Object(slicedToArray[\"a\" /* default */])(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=Object(react[\"useState\"])(0),_useState6=Object(slicedToArray[\"a\" /* default */])(_useState5,2),score=_useState6[0],setScore=_useState6[1];// const [canvas, setCanvas] = useState(<canvas></canvas>);\nvar mainRef=Object(react[\"useRef\"])(null);Object(react[\"useEffect\"])(function(){init();},[]);var updateScore=function updateScore(){// for ( let child of mainRef.current.children ) {\n//   child.delete()\n// }\nconsole.log(\"useEffect score\",mainRef,'score is',score);if(!mainRef.current){console.log('not updating score because',mainRef.current);// updateScore(); // hacky - should be removed\nreturn;}else{var scoreSpan=document.createElement('span');scoreSpan.innerText=score;scoreSpan.className=\"scoreSpan\";mainRef.current.appendChild(scoreSpan);}};Object(react[\"useLayoutEffect\"])(function(){updateScore();// Clean up\nreturn function(){var spans=document.getElementsByClassName('scoreSpan');var _iterator=Object(createForOfIteratorHelper[\"a\" /* default */])(spans),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var span=_step.value;span.remove();}}catch(err){_iterator.e(err);}finally{_iterator.f();}};},[score]);Object(react[\"useLayoutEffect\"])(function(){// for ( let child of mainRef.current.children ) {\n//   child.delete()\n// }\nconsole.log(\"useEffect\",mainRef);if(!mainRef.current){console.log('not updating narcissus because',mainRef.current);init();// hacky - should be removed\nreturn;}else{console.log('about to append because main is',mainRef.current,narcissus);var scoreSpan=document.createElement('span');scoreSpan.innerText=score;scoreSpan.className=\"scoreSpan\";narcissus.className='narcissus';mainRef.current.appendChild(narcissus);mainRef.current.appendChild(scoreSpan);}// Clean up\nreturn function(){console.log(\"clean up\");// mainRef.current.innerHTML = null\nvar narci=document.getElementsByClassName('narcissus');var _iterator2=Object(createForOfIteratorHelper[\"a\" /* default */])(narci),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var n=_step2.value;n.remove();}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}};},[narcissus]);/* -- Functions -- */var init=/*#__PURE__*/function(){var _ref=Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var correctFreezeFrame;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getCorrectFreezeFrame();case 2:correctFreezeFrame=_context.sent;console.log('setting frame',correctFreezeFrame);_context.next=6;return setGif(correctFreezeFrame);case 6:return _context.abrupt(\"return\",{state:state,id:id});case 7:case\"end\":return _context.stop();}}},_callee);}));return function init(){return _ref.apply(this,arguments);};}();function getData(_x){return _getData.apply(this,arguments);}function _getData(){_getData=Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(url){var response;return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios_default.a.get(url);case 3:response=_context2.sent;console.log(response);return _context2.abrupt(\"return\",response.data);case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return _getData.apply(this,arguments);}function getCorrectFreezeFrame(){return _getCorrectFreezeFrame.apply(this,arguments);}function _getCorrectFreezeFrame(){_getCorrectFreezeFrame=Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee3(){var oid,nft_state,koii_state,current,lockBlock,list,newScore,change,max,scalar,last,lastMax,i,_iterator3,_step3,item,aScore,remainder;return regenerator_default.a.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;oid=window.location.pathname.split('/')[1]||'1ZjIecqKGYdGTFMWR9kdGrmi77lMmZnA6dxEzWulyjo';// console.log('got oid', oid)\n// var nft_state = await ktools.readNftState(oid);\n_context3.next=4;return getData('https://arweave.net/1ZjIecqKGYdGTFMWR9kdGrmi77lMmZnA6dxEzWulyjo');case 4:nft_state=_context3.sent;_context3.next=7;return getData('https://arweave.net/cETTyJQYxJLVQ6nC3VxzsZf1x2-6TW2LFkGZa91gUWc');case 7:koii_state=_context3.sent;// contract state\ncurrent=nft_state.decay.lockState||0;lockBlock=nft_state.decay.lastLock;list=koii_state.stateUpdate.trafficLogs.rewardReport;// this will contain the output\n// looping variables\nchange=0;max=nft_state.decay.lastMax||1;scalar=1;last=0;lastMax=0;i=0;_iterator3=Object(createForOfIteratorHelper[\"a\" /* default */])(list);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){item=_step3.value;// console.log('checking', i, 'change is ', change)\nif(item.dailyTrafficBlock>lockBlock){if(typeof item.logsSummary&&Object.keys(item.logsSummary).includes(oid)){aScore=item.logsSummary[oid];if(aScore<max){if(last===i-1){// if we are on a streak, incremement the scalar\nscalar=scalar+scalar;}if(i-10<lastMax){// we are in a recovery slump, so the scalar is negative now\nscalar=-1*scalar;}// increment the adjustment \nchange=change+aScore*(1+scalar/100);}else{// if we have a new max we get a major boost\nmax=aScore;lastMax=i;change=change+10000;}last=i;}}i=i+1;}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}if(change<1){// return current;\nconsole.log('returning current',current);newScore=current;// return 200;\n}else{// return current + change;\nremainder=totalFrames-current;// the maximum score adjustment we can give (total frames less current score)\nnewScore=remainder*(10001-change);if(newScore>totalFrames){newScore=totalFrames;}else if(newScore<0){newScore=0;}}// newScore = 200; // enable to check gif scrolling locally\nconsole.log('newScore is',newScore);setScore(newScore);return _context3.abrupt(\"return\",newScore);case 25:_context3.prev=25;_context3.t0=_context3[\"catch\"](0);console.log('error loading nft data',_context3.t0);setScore(1);return _context3.abrupt(\"return\",1);case 30:case\"end\":return _context3.stop();}}},_callee3,null,[[0,25]]);}));return _getCorrectFreezeFrame.apply(this,arguments);}function setGif(_x2){return _setGif.apply(this,arguments);}// const renderImage = () => {\n//   // console.log(canvas, typeof(canvas), JSON.stringify(canvas))\n//   // for ( let child of mainRef.current.children ) {\n//   //   child.delete()\n//   // }\n//   console.log('CANVAAS', canvas, typeof(canvas))\n//   let copy = canvas.cloneNode(true)\n//   mainRef.current.insertAdjacentElement('afterbegin', copy)\n// }\nfunction _setGif(){_setGif=Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee4(frameToSet){return regenerator_default.a.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",new Promise(function(resolve,reject){try{gif_frames_default()({url:\"./img/narcissus.gif\",frames:\"0-1000\",outputType:\"canvas\"}).then(function(frameData){// console.log('setting frame', frameToSet, frameData[frameToSet])\nvar obj=frameData[frameToSet].getImage();setNarcissus(obj);setLoading(false);resolve(frameData);}).catch(console.error.bind(console));}catch(err){console.log(\"err\",err);reject(err);}}));case 1:case\"end\":return _context4.stop();}}},_callee4);}));return _setGif.apply(this,arguments);}return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"App\",children:[loading&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{alt:\"this is the loading icon\",src:window.location.origin+\"/img/narcissus.gif\"}),!loading&&/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(react_default.a.Fragment,{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"header\",{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"main\",{ref:mainRef}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"./img/narcissus.gif\"})]})]});}/* harmony default export */ var src_App = (App_App);// need to fetch the attention logs from koi state\n// then, iterate over the logs and sum the total attention\n// then, check the last time the nft was updated\n// then, check the nft's decay from it's state.decay\n// then, increment counters based on the difference of current block height and the block height at last adjustment\n// then, adjust the 'durability' score\n// CONCATENATED MODULE: ./src/reportWebVitals.js\nvar reportWebVitals=function reportWebVitals(onPerfEntry){if(onPerfEntry&&onPerfEntry instanceof Function){__webpack_require__.e(/* import() */ 3).then(__webpack_require__.bind(null, 552)).then(function(_ref){var getCLS=_ref.getCLS,getFID=_ref.getFID,getFCP=_ref.getFCP,getLCP=_ref.getLCP,getTTFB=_ref.getTTFB;getCLS(onPerfEntry);getFID(onPerfEntry);getFCP(onPerfEntry);getLCP(onPerfEntry);getTTFB(onPerfEntry);});}};/* harmony default export */ var src_reportWebVitals = (reportWebVitals);\n// CONCATENATED MODULE: ./src/index.js\nreact_dom_default.a.render(/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_default.a.StrictMode,{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(src_App,{})}),document.getElementById('root'));// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nsrc_reportWebVitals();\n\n/***/ })\n\n},[[551,1,2]]]);","inputSourceMap":{"version":3,"sources":["ignored /home/al/Desktop/koi/narcissus/content/node_modules/node-forge/lib crypto","/home/al/Desktop/koi/narcissus/content/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-4-0!/home/al/Desktop/koi/narcissus/content/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-4-1!/home/al/Desktop/koi/narcissus/content/node_modules/postcss-loader/src/index.js??postcss!/home/al/Desktop/koi/narcissus/content/src/index.css","ignored /home/al/Desktop/koi/narcissus/content/node_modules/hash-base/node_modules/readable-stream/lib util","ignored /home/al/Desktop/koi/narcissus/content/node_modules/hash-base/node_modules/readable-stream/lib/internal/streams util","ignored /home/al/Desktop/koi/narcissus/content/node_modules/readable-stream/lib util","ignored /home/al/Desktop/koi/narcissus/content/node_modules/readable-stream/lib/internal/streams util","ignored /home/al/Desktop/koi/narcissus/content/node_modules/bn.js/lib buffer","ignored /home/al/Desktop/koi/narcissus/content/node_modules/brorand crypto","ignored /home/al/Desktop/koi/narcissus/content/node_modules/browserify-sign/node_modules/readable-stream/lib util","ignored /home/al/Desktop/koi/narcissus/content/node_modules/browserify-sign/node_modules/readable-stream/lib/internal/streams util","ignored /home/al/Desktop/koi/narcissus/content/node_modules/browserify-rsa/node_modules/bn.js/lib buffer","ignored /home/al/Desktop/koi/narcissus/content/node_modules/browserify-sign/node_modules/bn.js/lib buffer","ignored /home/al/Desktop/koi/narcissus/content/node_modules/gif-encoder/node_modules/readable-stream/lib util","/home/al/Desktop/koi/narcissus/content/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-4-0!/home/al/Desktop/koi/narcissus/content/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-4-1!/home/al/Desktop/koi/narcissus/content/node_modules/postcss-loader/src/index.js??postcss!/home/al/Desktop/koi/narcissus/content/src/App.css","/home/al/Desktop/koi/narcissus/content/src/App.js","/home/al/Desktop/koi/narcissus/content/src/reportWebVitals.js","/home/al/Desktop/koi/narcissus/content/src/index.js"],"names":["ktools","kweb","console","log","state","id","koii","totalFrames","App","useState","narcissus","setNarcissus","loading","setLoading","score","setScore","mainRef","useRef","useEffect","init","updateScore","current","scoreSpan","document","createElement","innerText","className","appendChild","useLayoutEffect","spans","getElementsByClassName","span","remove","narci","n","getCorrectFreezeFrame","correctFreezeFrame","setGif","getData","url","axios","get","response","data","error","oid","window","location","pathname","split","nft_state","koii_state","decay","lockState","lockBlock","lastLock","list","stateUpdate","trafficLogs","rewardReport","change","max","lastMax","scalar","last","i","item","dailyTrafficBlock","logsSummary","Object","keys","includes","aScore","newScore","remainder","frameToSet","Promise","resolve","reject","gifFrames","frames","outputType","then","frameData","obj","getImage","catch","bind","err","origin","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","getElementById"],"mappings":"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","file":"x","sourcesContent":["/* (ignored) */","// extracted by mini-css-extract-plugin","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","// extracted by mini-css-extract-plugin","import React, { useState, useEffect, useLayoutEffect, useRef } from \"react\";\n\nimport * as kweb from \"@_koi/sdk/web\";\nimport gifFrames from \"gif-frames\";\nimport axios from 'axios';\n\n// import SmartWeave from \"smartweave\";\n\nimport \"./App.css\";\n\nconst ktools = new kweb.Web();\n\nconsole.log(\"ktools\", ktools);\n\nlet state;\nlet id;\nlet koii;\nlet totalFrames = 225;\n\nfunction App() {\n  const [narcissus, setNarcissus] = useState(<canvas></canvas>);\n  const [loading, setLoading] = useState(true);\n  const [score, setScore] = useState(0);\n  // const [canvas, setCanvas] = useState(<canvas></canvas>);\n  const mainRef = useRef(null);\n\n  useEffect(() => {\n    init();\n  }, []);\n\n  const updateScore = () => {\n      // for ( let child of mainRef.current.children ) {\n    //   child.delete()\n    // }\n    console.log(\"useEffect score\", mainRef, 'score is', score);\n    if (!mainRef.current) {\n      console.log('not updating score because', mainRef.current)\n      // updateScore(); // hacky - should be removed\n      return;\n    } else {\n      let scoreSpan = document.createElement('span')\n          scoreSpan.innerText = score;\n          scoreSpan.className = \"scoreSpan\"\n        \n      mainRef.current.appendChild(scoreSpan);\n    }\n  }\n\n  useLayoutEffect(() => {\n    updateScore();\n\n    // Clean up\n    return () => {\n      var spans = document.getElementsByClassName('scoreSpan')\n      for ( let span of spans ) {\n        span.remove()\n      }\n    };\n  }, [score]);\n\n  useLayoutEffect(() => {\n    // for ( let child of mainRef.current.children ) {\n    //   child.delete()\n    // }\n    console.log(\"useEffect\", mainRef);\n    if (!mainRef.current) {\n      console.log('not updating narcissus because', mainRef.current)\n      init(); // hacky - should be removed\n      return;\n    } else {\n      console.log('about to append because main is', mainRef.current, narcissus)\n      let scoreSpan = document.createElement('span')\n          scoreSpan.innerText = score;\n          scoreSpan.className = \"scoreSpan\"\n      narcissus.className = 'narcissus'\n      mainRef.current.appendChild(narcissus);\n      mainRef.current.appendChild(scoreSpan);\n    }\n\n    // Clean up\n    return () => {\n      console.log(\"clean up\");\n      // mainRef.current.innerHTML = null\n      let narci = document.getElementsByClassName('narcissus')\n      for ( let n of narci ) {\n        n.remove()\n      }\n\n    };\n  }, [narcissus]);\n\n  /* -- Functions -- */\n\n  const init = async () => {\n    // should add the following flower to the view, replacing the loading icon\n    let correctFreezeFrame = await getCorrectFreezeFrame()\n    console.log('setting frame', correctFreezeFrame)\n    await setGif(correctFreezeFrame);\n\n    return { state, id };\n  };\n\n  async function getData (url) {\n    try {\n      const response = await axios.get(url);\n      console.log(response);\n      return response.data;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function getCorrectFreezeFrame() {\n    try {\n      var oid = (window.location.pathname).split('/')[1] || '1ZjIecqKGYdGTFMWR9kdGrmi77lMmZnA6dxEzWulyjo';\n      // console.log('got oid', oid)\n      // var nft_state = await ktools.readNftState(oid);\n      var nft_state = await getData('https://arweave.net/1ZjIecqKGYdGTFMWR9kdGrmi77lMmZnA6dxEzWulyjo')\n      \n      // var koii_state = await ktools.getContractState();\n      var koii_state = await getData('https://arweave.net/cETTyJQYxJLVQ6nC3VxzsZf1x2-6TW2LFkGZa91gUWc');\n\n      // contract state\n      let current = nft_state.decay.lockState || 0;\n      let lockBlock = nft_state.decay.lastLock;\n      let list = koii_state.stateUpdate.trafficLogs.rewardReport;\n      let newScore; // this will contain the output\n\n      // looping variables\n      let change = 0;\n      let max = nft_state.decay.lastMax || 1;\n      let scalar = 1;\n      let last = 0;\n      let lastMax = 0;\n      let i = 0;\n\n      for ( var item of list ) {\n        // console.log('checking', i, 'change is ', change)\n        if ( item.dailyTrafficBlock > lockBlock ) { \n            if ( typeof(item.logsSummary) && Object.keys(item.logsSummary).includes(oid) ) {\n              let aScore = item.logsSummary[oid];\n              if ( aScore < max ) {\n                \n                if ( last === i - 1 ) {\n                  // if we are on a streak, incremement the scalar\n                  scalar = scalar + scalar;\n                }\n                \n                if ( ( i - 10 ) < lastMax ) {\n                  // we are in a recovery slump, so the scalar is negative now\n                  scalar = ( -1 ) * scalar;\n                }\n                \n                // increment the adjustment \n                change = change + aScore * ( 1 + scalar / 100 )\n\n              } else {\n                // if we have a new max we get a major boost\n                max = aScore;\n                lastMax = i;\n                change = change + 10000;\n              }\n              last = i;\n            }\n        }\n        i = i + 1;\n      }\n      \n      if (change < 1) {\n        // return current;\n        console.log('returning current', current)\n        newScore = current;\n        // return 200;\n      } else {\n        // return current + change;\n        let remainder = totalFrames - current; // the maximum score adjustment we can give (total frames less current score)\n        newScore = remainder * ( 10001 - change );\n        if ( newScore > totalFrames ) {\n          newScore = totalFrames;\n        } else if ( newScore < 0 ) {\n          newScore = 0;\n        }\n      }\n      // newScore = 200; // enable to check gif scrolling locally\n      console.log('newScore is', newScore)\n      setScore(newScore);\n      return newScore;\n    } catch (err) {\n      console.log('error loading nft data', err)\n      setScore(1)\n      return 1;\n    }\n  }\n\n  async function setGif(frameToSet) {\n    return new Promise(function (resolve, reject) {\n      try {\n        gifFrames({ url: \"./img/narcissus.gif\", frames: \"0-1000\", outputType: \"canvas\" })\n          .then(function (frameData) {\n            // console.log('setting frame', frameToSet, frameData[frameToSet])\n            let obj = frameData[frameToSet].getImage();\n            setNarcissus(obj);\n            setLoading(false);\n            resolve(frameData);\n          })\n          .catch(console.error.bind(console));\n      } catch (err) {\n        console.log(\"err\", err);\n        reject(err);\n      }\n    });\n  }\n\n  // const renderImage = () => {\n\n  //   // console.log(canvas, typeof(canvas), JSON.stringify(canvas))\n\n  //   // for ( let child of mainRef.current.children ) {\n  //   //   child.delete()\n  //   // }\n\n  //   console.log('CANVAAS', canvas, typeof(canvas))\n\n  //   let copy = canvas.cloneNode(true)\n\n  //   mainRef.current.insertAdjacentElement('afterbegin', copy)\n  // }\n\n  return (\n    <div className=\"App\">\n      {loading && (\n        <img alt=\"this is the loading icon\" src={window.location.origin + \"/img/narcissus.gif\"} />\n      )}\n      {!loading && (\n        <React.Fragment>\n          <header></header>\n          <main ref={mainRef}></main>\n          <img src=\"./img/narcissus.gif\"></img>\n        </React.Fragment>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n\n// need to fetch the attention logs from koi state\n// then, iterate over the logs and sum the total attention\n// then, check the last time the nft was updated\n// then, check the nft's decay from it's state.decay\n// then, increment counters based on the difference of current block height and the block height at last adjustment\n// then, adjust the 'durability' score\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"]}}